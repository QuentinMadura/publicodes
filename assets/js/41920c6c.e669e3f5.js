"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[705],{5318:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>k});var r=n(7378);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=s(n),d=a,k=u["".concat(p,".").concat(d)]||u[d]||c[d]||i;return n?r.createElement(k,o(o({ref:t},m),{},{components:n})):r.createElement(k,o({ref:t},m))}));function k(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:a,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6248:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var r=n(5773),a=(n(7378),n(5318));const i={sidebar_position:2,title:"Imports de r\xe8gles",hide_table_of_contents:!1},o=void 0,l={unversionedId:"tools/imports",id:"tools/imports",title:"Imports de r\xe8gles",description:"Afin de pouvoir r\xe9utiliser des r\xe8gles d'un mod\xe8le \xe0 un autre, il est n\xe9cessaire",source:"@site/docs/tools/imports.mdx",sourceDirName:"tools",slug:"/tools/imports",permalink:"/docs/tools/imports",draft:!1,editUrl:"https://github.com/betagouv/publicodes/edit/master/website/docs/tools/imports.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"Imports de r\xe8gles",hide_table_of_contents:!1},sidebar:"tutorialSidebar",previous:{title:"Compilation",permalink:"/docs/tools/compilation"},next:{title:"Optimisations",permalink:"/docs/tools/optim"}},p={},s=[{value:"Importer des r\xe8gles depuis un mod\xe8le compil\xe9",id:"importer-des-r\xe8gles-depuis-un-mod\xe8le-compil\xe9",level:2},{value:"Usage",id:"usage",level:3},{value:"Exemple",id:"exemple",level:4},{value:"Liste des mod\xe8les publi\xe9s",id:"liste-des-mod\xe8les-publi\xe9s",level:2}],m={toc:s},u="wrapper";function c(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Afin de pouvoir r\xe9utiliser des r\xe8gles d'un mod\xe8le \xe0 un autre, il est n\xe9cessaire\nde pouvoir importer des r\xe8gles d'un autre mod\xe8le."),(0,a.kt)("p",null,"Pour ce faire nous avons d\xe9fini une macro ",(0,a.kt)("inlineCode",{parentName:"p"},"importer!")," qui permet de sp\xe9cifier\nune liste de r\xe8gles \xe0 importer depuis un fichier JSON d'un ",(0,a.kt)("a",{parentName:"p",href:"./compilation"},"mod\xe8le\ncompil\xe9"),". Par d\xe9faut, le fichier JSON est recherch\xe9 dans le\npackage NPM du mod\xe8le ou bien il est possible de sp\xe9cifier un chemin vers un\nfichier local."),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"La macro ",(0,a.kt)("inlineCode",{parentName:"p"},"importer!")," est une macro de compilation et est d\xe9pendante de\n",(0,a.kt)("a",{parentName:"p",href:"compilation#g%C3%A9n%C3%A9rer-un-mod%C3%A8le-json-%C3%A0-partir-des-fichiers-sources"},(0,a.kt)("inlineCode",{parentName:"a"},"getModelFromSource")),"\npour fonctionner.")),(0,a.kt)("h2",{id:"importer-des-r\xe8gles-depuis-un-mod\xe8le-compil\xe9"},"Importer des r\xe8gles depuis un mod\xe8le compil\xe9"),(0,a.kt)("p",null,"Pour pouvoir utiliser un ensemble de r\xe8gles d'un autre mod\xe8le, il faut sp\xe9cifier\nla macro ",(0,a.kt)("inlineCode",{parentName:"p"},"importer!")," au d\xe9but d'un fichier publicodes."),(0,a.kt)("h3",{id:"usage"},"Usage"),(0,a.kt)("p",null,"La macro ",(0,a.kt)("inlineCode",{parentName:"p"},"importer!")," poss\xe8de la syntaxe suivante :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"importer!:\n  depuis:\n    nom: <npm_package_name>\n    source: <path_to_the_model_file> (optional)\n    url: <url_to_the_package_documentation> (optional)\n  dans: <namespace> (optional)\n  les r\xe8gles:\n    - <rule_name_from_the_npm_package>\n    - <rule_name_from_the_npm_package>:\n      <attr_to_overwrite>: <value>\n      ...\n    ...\n")),(0,a.kt)("p",null,"Avec :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"depuis")," : les informations sur le mod\xe8le \xe0 importer",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"nom")," : le nom du package NPM du mod\xe8le \xe0 importer"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"source")," : le chemin vers le fichier JSON du mod\xe8le \xe0 importer (optionnel)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"url")," : l'URL vers la documentation du mod\xe8le \xe0 importer (optionnel)"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"dans")," : le namespace dans lequel importer les r\xe8gles (optionnel)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"les r\xe8gles")," : la liste des r\xe8gles \xe0 importer. Il est possible de sp\xe9cifier\ndes attributs \xe0 \xe9craser pour chaque r\xe8gle (optionnel)")),(0,a.kt)("p",null,"Par d\xe9faut, si aucune ",(0,a.kt)("inlineCode",{parentName:"p"},"source")," n'est sp\xe9cifi\xe9e, le mod\xe8le est suppos\xe9 \xeatre\n",(0,a.kt)("a",{parentName:"p",href:"./compilation"},"compil\xe9")," dans le fichier ",(0,a.kt)("inlineCode",{parentName:"p"},"<package_name>.model.json")," \xe0 la racine\ndu package NPM. Le package NPM du mod\xe8le \xe0 utiliser doit donc ",(0,a.kt)("strong",{parentName:"p"},"\xeatre publi\xe9 sur\nNPM")," et \xeatre ",(0,a.kt)("strong",{parentName:"p"},"ajout\xe9 aux d\xe9pendances du projet")," courant.\nIl est \xe9galement possible de sp\xe9cifier le chemin vers un fichier local avec\n",(0,a.kt)("inlineCode",{parentName:"p"},"source"),"."),(0,a.kt)("p",null,"Si ",(0,a.kt)("inlineCode",{parentName:"p"},"dans")," n'est pas sp\xe9cifi\xe9, les r\xe8gles seront import\xe9es dans le namespace\ncorrespondant au nom du package NPM (",(0,a.kt)("inlineCode",{parentName:"p"},"nom"),")."),(0,a.kt)("admonition",{title:"Fonctionnement",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"A la compilation, chaque macro ",(0,a.kt)("inlineCode",{parentName:"p"},"importer!")," est remplac\xe9e par les r\xe8gles\nimport\xe9es ",(0,a.kt)("strong",{parentName:"p"},"ainsi que leurs d\xe9pendances"),".")),(0,a.kt)("h4",{id:"exemple"},"Exemple"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="nosgestesclimat/data/logement/piscine.publicodes"',title:'"nosgestesclimat/data/logement/piscine.publicodes"'},"importer!:\n  depuis:\n    nom: futureco-data\n    url: https://github.com/laem/futureco-data\n  dans: logement\n  les r\xe8gles:\n    - piscine . empreinte eau froide\n    - piscine . traitement chimique\n    - piscine . construction\n    - piscine . surface:\n        applicable si: piscine . pr\xe9sent\n        question: Quelle est la taille de votre piscine ?\n        description: |\n          \ud83d\udca1 Pensez \xe0 prendre en compte **les consommations d'\xe9nergie de la piscine dans celles de votre logement**. Votre facture devrait d'ailleurs \xeatre fortement impact\xe9e si votre piscine est chauff\xe9e !\n        unit\xe9: m2\n        suggestions:\n          3 x 5 m\xe8tres: 15\n          5 x 5 m\xe8tres: 20\n          5 x 8 m\xe8tres: 40\n")),(0,a.kt)("h2",{id:"liste-des-mod\xe8les-publi\xe9s"},"Liste des mod\xe8les publi\xe9s"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/laem/futureco-data"},(0,a.kt)("inlineCode",{parentName:"a"},"futureco-data")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"mod\xe8le de ",(0,a.kt)("a",{parentName:"em",href:"https://futur.eco"},"futur.eco"),".")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/incubateur-ademe/nosgestesclimat"},(0,a.kt)("inlineCode",{parentName:"a"},"@incubateur-ademe/nosgestesclimat")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"mod\xe8le de ",(0,a.kt)("a",{parentName:"em",href:"https://nosgestesclimat.fr"},"Nos Gestes Climat"),".")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/incubateur-ademe/publicodes-impact-livraison"},(0,a.kt)("inlineCode",{parentName:"a"},"@incubateur-ademe/publicodes-impact-livraison")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"mod\xe8le du simulateur Impact Livraison de ",(0,a.kt)("a",{parentName:"em",href:"https://impactco2.fr"},"Impact\nCO2"),".")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/incubateur-ademe/publicodes-negaoctet"},(0,a.kt)("inlineCode",{parentName:"a"},"@incubateur-ademe/publicodes-negaoctet")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"mod\xe8le publicodes de la base de donn\xe9es de\n",(0,a.kt)("a",{parentName:"em",href:"https://negaoctet.org/en/home/#Donnees"},"NegaOctet")," utilis\xe9 par ",(0,a.kt)("a",{parentName:"em",href:"https://impactco2.fr"},"Impact\nCO2"),".")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/incubateur-ademe/publicodes-commun"},(0,a.kt)("inlineCode",{parentName:"a"},"@incubateur-ademe/publicodes-commun")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"ensemble de r\xe8gles communes utilis\xe9es pour l'impl\xe9mentation des mod\xe8les\npublicodes de l'incubateur de l'ADEME."))))))}c.isMDXComponent=!0}}]);
//# sourceMappingURL=41920c6c.e669e3f5.js.map